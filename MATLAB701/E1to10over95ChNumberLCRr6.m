% E1to10over95ChNumberLCRr6
function NumberTvsRev=E1to10over95ChNumberLCRr6(M4,M6,N,V)
% M4:FFTby4HzBB; M6:FFTby6.66HzBB; N:FFTbyNoBB; V:channels202XY 
% In 4HzBB, find channel in which there find 4Hz peak over 95 
C4=(((M4(55,(1:202))>mean(M4(([49:53 58:63]),(1:202)),1)+std(M4(([49:53 58:63]),(1:202)),0,1)*1.64)...
    &(M4(54,(1:202))<mean(M4(([49:53 58:63]),(1:202)),1)+std(M4(([49:53 58:63]),(1:202)),0,1)*1.64)...
    &(M4(57,(1:202))<mean(M4(([49:53 58:63]),(1:202)),1)+std(M4(([49:53 58:63]),(1:202)),0,1)*1.64))...
    |((M4(56,(1:202))>mean(M4(([49:53 58:63]),(1:202)),1)+std(M4(([49:53 58:63]),(1:202)),0,1)*1.64)...
    &(M4(54,(1:202))<mean(M4(([49:53 58:63]),(1:202)),1)+std(M4(([49:53 58:63]),(1:202)),0,1)*1.64)...
    &(M4(57,(1:202))<mean(M4(([49:53 58:63]),(1:202)),1)+std(M4(([49:53 58:63]),(1:202)),0,1)*1.64)));
C4rev=(C4*(-1))+ones(size(C4));
% In 666HzBB, find channel in which there find no 4Hz peak over 95
C6pre=(((M6(55,(1:202))>mean(M6(([49:53 58:63]),(1:202)),1)+std(M6(([49:53 58:63]),(1:202)),0,1)*1.64)...
    &(M6(54,(1:202))<mean(M6(([49:53 58:63]),(1:202)),1)+std(M6(([49:53 58:63]),(1:202)),0,1)*1.64)...
    &(M6(57,(1:202))<mean(M6(([49:53 58:63]),(1:202)),1)+std(M6(([49:53 58:63]),(1:202)),0,1)*1.64))...
    |((M6(56,(1:202))>mean(M6(([49:53 58:63]),(1:202)),1)+std(M6(([49:53 58:63]),(1:202)),0,1)*1.64)...
    &(M6(54,(1:202))<mean(M6(([49:53 58:63]),(1:202)),1)+std(M6(([49:53 58:63]),(1:202)),0,1)*1.64)...
    &(M6(57,(1:202))<mean(M6(([49:53 58:63]),(1:202)),1)+std(M6(([49:53 58:63]),(1:202)),0,1)*1.64)));
C6=(C6pre*(-1))+ones(size(C6pre));
% In NoBB, find channel in which there find no 4Hz peak over 95
CNpre=(((N(55,(1:202))>mean(N(([49:53 58:63]),(1:202)),1)+std(N(([49:53 58:63]),(1:202)),0,1)*1.64)...
    &(N(54,(1:202))<mean(N(([49:53 58:63]),(1:202)),1)+std(N(([49:53 58:63]),(1:202)),0,1)*1.64)...
    &(N(57,(1:202))<mean(N(([49:53 58:63]),(1:202)),1)+std(N(([49:53 58:63]),(1:202)),0,1)*1.64))...
    |((N(56,(1:202))>mean(N(([49:53 58:63]),(1:202)),1)+std(N(([49:53 58:63]),(1:202)),0,1)*1.64)...
    &(N(54,(1:202))<mean(N(([49:53 58:63]),(1:202)),1)+std(N(([49:53 58:63]),(1:202)),0,1)*1.64)...
    &(N(57,(1:202))<mean(N(([49:53 58:63]),(1:202)),1)+std(N(([49:53 58:63]),(1:202)),0,1)*1.64)));
CN=(CNpre*(-1))+ones(size(CNpre));
% find propriate channels
C=(C4.*C6).*CN;
SelectChs=V(:,find(C>0));
Crev=(CNpre.*C6).*C4rev;
SelectChs_rev=V(:,find(Crev>0));
% find number of propriate channels
NumberLCR=[nnz(SelectChs(2,:)==1) nnz(SelectChs(2,:)==0) nnz(SelectChs(2,:)==2)];
assignin('base',[inputname(1) '_SelectChs95r6'],SelectChs);
assignin('base',[inputname(1) '_NumberLCR95r6'],NumberLCR);
NumberLCR_rev=[nnz(SelectChs_rev(2,:)==1) nnz(SelectChs_rev(2,:)==0) nnz(SelectChs_rev(2,:)==2)];
assignin('base',[inputname(1) '_SelectChs95r6rev'],SelectChs_rev);
assignin('base',[inputname(1) '_NumberLCR95r6rev'],NumberLCR_rev);
NumberTvsRev=[NumberLCR;NumberLCR_rev];
plot(M4((15:137),203)/1000,M4((15:137),find(C>0)),'b',M6((15:137),203)/1000,M6((15:137),find(C>0)),'r',N((15:137),203)/1000,N((15:137),find(C>0)),'k'),grid on
end
