% E1to10AllChDiffN9fInt005v3
function P=E1to10AllChDiffN9fInt005v3(M1,M2,M3,M4,M5,M6,M7,M8,M9,N1,N2,N3,N4,N5,N6,N7,N8,N9,V)
for c=1:202
    M1S((1:123),c)=M1((15:137),c)/sum(M1((15:137),c))*123;
    M2S((1:123),c)=M2((15:137),c)/sum(M2((15:137),c))*123;
    M3S((1:123),c)=M3((15:137),c)/sum(M3((15:137),c))*123;
    M4S((1:123),c)=M4((15:137),c)/sum(M4((15:137),c))*123;
    M5S((1:123),c)=M5((15:137),c)/sum(M5((15:137),c))*123;
    M6S((1:123),c)=M6((15:137),c)/sum(M6((15:137),c))*123;
    M7S((1:123),c)=M7((15:137),c)/sum(M7((15:137),c))*123;
    M8S((1:123),c)=M8((15:137),c)/sum(M8((15:137),c))*123;
    M9S((1:123),c)=M9((15:137),c)/sum(M9((15:137),c))*123;
    N1S((1:123),c)=N1((15:137),c)/sum(N1((15:137),c))*123;
    N2S((1:123),c)=N2((15:137),c)/sum(N2((15:137),c))*123;
    N3S((1:123),c)=N3((15:137),c)/sum(N3((15:137),c))*123;
    N4S((1:123),c)=N4((15:137),c)/sum(N4((15:137),c))*123;
    N5S((1:123),c)=N5((15:137),c)/sum(N5((15:137),c))*123;
    N6S((1:123),c)=N6((15:137),c)/sum(N6((15:137),c))*123;
    N7S((1:123),c)=N7((15:137),c)/sum(N7((15:137),c))*123;
    N8S((1:123),c)=N8((15:137),c)/sum(N8((15:137),c))*123;
    N9S((1:123),c)=N9((15:137),c)/sum(N9((15:137),c))*123;
end;    
D1S=[(M1S(:,(1:202))-N1S(:,(1:202))),M1((15:137),203)];
D2S=[(M2S(:,(1:202))-N2S(:,(1:202))),M2((15:137),203)];
D3S=[(M3S(:,(1:202))-N3S(:,(1:202))),M3((15:137),203)];
D4S=[(M4S(:,(1:202))-N4S(:,(1:202))),M4((15:137),203)];
D5S=[(M5S(:,(1:202))-N5S(:,(1:202))),M5((15:137),203)];
D6S=[(M6S(:,(1:202))-N6S(:,(1:202))),M6((15:137),203)];
D7S=[(M7S(:,(1:202))-N7S(:,(1:202))),M7((15:137),203)];
D8S=[(M8S(:,(1:202))-N8S(:,(1:202))),M8((15:137),203)];
D9S=[(M9S(:,(1:202))-N9S(:,(1:202))),M9((15:137),203)];
P((1:123),4)=M1((15:137),203)/1000;
for fp=1:123
    Mid1=D1S(fp,find(V(2,([1 (3:139) (141:177) (179:202)]))==0));
    Mid2=D2S(fp,find(V(2,([1 (3:139) (141:177) (179:202)]))==0));
    Mid3=D3S(fp,find(V(2,([1 (3:139) (141:177) (179:202)]))==0));
    Mid4=D4S(fp,find(V(2,([1 (3:139) (141:177) (179:202)]))==0));
    Mid5=D5S(fp,find(V(2,([1 (3:139) (141:177) (179:202)]))==0));
    Mid6=D6S(fp,find(V(2,([1 (3:139) (141:177) (179:202)]))==0));
    Mid7=D7S(fp,find(V(2,([1 (3:139) (141:177) (179:202)]))==0));
    Mid8=D8S(fp,find(V(2,([1 (3:139) (141:177) (179:202)]))==0));
    Mid9=D9S(fp,find(V(2,([1 (3:139) (141:177) (179:202)]))==0));
    if sum([Mid1 Mid2 Mid3 Mid4 Mid5 Mid6 Mid7 Mid8 Mid9])<0
        P(fp,2)=1
    else
        [H,P(fp,2),ci]=ttest([sum(Mid1) sum(Mid2) sum(Mid3) sum(Mid4) sum(Mid5) sum(Mid6) sum(Mid7) sum(Mid8) sum(Mid9)],0,0.05,0);
    end;
    Lt1=D1S(fp,find(V(2,([1 (3:139) (141:177) (179:202)]))==1));
    Lt2=D2S(fp,find(V(2,([1 (3:139) (141:177) (179:202)]))==1));
    Lt3=D3S(fp,find(V(2,([1 (3:139) (141:177) (179:202)]))==1));
    Lt4=D4S(fp,find(V(2,([1 (3:139) (141:177) (179:202)]))==1));
    Lt5=D5S(fp,find(V(2,([1 (3:139) (141:177) (179:202)]))==1));
    Lt6=D6S(fp,find(V(2,([1 (3:139) (141:177) (179:202)]))==1));
    Lt7=D7S(fp,find(V(2,([1 (3:139) (141:177) (179:202)]))==1));
    Lt8=D8S(fp,find(V(2,([1 (3:139) (141:177) (179:202)]))==1));
    Lt9=D9S(fp,find(V(2,([1 (3:139) (141:177) (179:202)]))==1));
    if sum([Lt1 Lt2 Lt3 Lt4 Lt5 Lt6 Lt7 Lt8 Lt9])<0
        P(fp,1)=1
    else
        [H,P(fp,1),ci]=ttest([sum(Lt1) sum(Lt2) sum(Lt3) sum(Lt4) sum(Lt5) sum(Lt6) sum(Lt7) sum(Lt8) sum(Lt9)],0,0.05,0);
    end;
    Rt1=D1S(fp,find(V(2,([1 (3:139) (141:177) (179:202)]))==2));
    Rt2=D2S(fp,find(V(2,([1 (3:139) (141:177) (179:202)]))==2));
    Rt3=D3S(fp,find(V(2,([1 (3:139) (141:177) (179:202)]))==2));
    Rt4=D4S(fp,find(V(2,([1 (3:139) (141:177) (179:202)]))==2));
    Rt5=D5S(fp,find(V(2,([1 (3:139) (141:177) (179:202)]))==2));
    Rt6=D6S(fp,find(V(2,([1 (3:139) (141:177) (179:202)]))==2));
    Rt7=D7S(fp,find(V(2,([1 (3:139) (141:177) (179:202)]))==2));
    Rt8=D8S(fp,find(V(2,([1 (3:139) (141:177) (179:202)]))==2));
    Rt9=D9S(fp,find(V(2,([1 (3:139) (141:177) (179:202)]))==2));
    if sum([Rt1 Rt2 Rt3 Rt4 Rt5 Rt6 Rt7 Rt8 Rt9])<0
        P(fp,3)=1
    else
        [H,P(fp,3),ci]=ttest([sum(Rt1) sum(Rt2) sum(Rt3) sum(Rt4) sum(Rt5) sum(Rt6) sum(Rt7) sum(Rt8) sum(Rt9)],0,0.05,0);
    end;
end;
assignin('base','P',P);
[i,j]=find(P((1:123),(1:3))<0.05);
plot(j,P(i,4),'b.'),hold on;
end
