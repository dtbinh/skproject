% E1to10AllChDiffN9fInt005vsNEW102one
function SigChN=E1to10AllChDiffN9fInt005vsNEW102one(M1,M2,M3,M4,M5,M6,M7,M8,M9,N1,N2,N3,N4,N5,N6,N7,N8,N9,V)
M((1:123),(1:200),1)=M1((15:137),([1 (3:165) (167:202)]));
M((1:123),(1:200),2)=M2((15:137),([1 (3:165) (167:202)]));
M((1:123),(1:200),3)=M3((15:137),([1 (3:165) (167:202)]));
M((1:123),(1:200),4)=M4((15:137),([1 (3:165) (167:202)]));
M((1:123),(1:200),5)=M5((15:137),([1 (3:165) (167:202)]));
M((1:123),(1:200),6)=M6((15:137),([1 (3:165) (167:202)]));
M((1:123),(1:200),7)=M7((15:137),([1 (3:165) (167:202)]));
M((1:123),(1:200),8)=M8((15:137),([1 (3:165) (167:202)]));
M((1:123),(1:200),9)=M9((15:137),([1 (3:165) (167:202)]));
N((1:123),(1:200),1)=N1((15:137),([1 (3:165) (167:202)]));
N((1:123),(1:200),2)=N2((15:137),([1 (3:165) (167:202)]));
N((1:123),(1:200),3)=N3((15:137),([1 (3:165) (167:202)]));
N((1:123),(1:200),4)=N4((15:137),([1 (3:165) (167:202)]));
N((1:123),(1:200),5)=N5((15:137),([1 (3:165) (167:202)]));
N((1:123),(1:200),6)=N6((15:137),([1 (3:165) (167:202)]));
N((1:123),(1:200),7)=N7((15:137),([1 (3:165) (167:202)]));
N((1:123),(1:200),8)=N8((15:137),([1 (3:165) (167:202)]));
N((1:123),(1:200),9)=N9((15:137),([1 (3:165) (167:202)]));
for m2=1:9
    for c2=1:100
        Z=M((1:123),c2,m2).^2+M((1:123),(c2+100),m2).^2;
        MM((1:123),c2,m2)=Z/mean(Z);
    end;
end;
clear Z;
for n2=1:9
    for b2=1:100
        Y=N((1:123),b2,n2).^2+N((1:123),(b2+100),n2).^2;
        NN((1:123),b2,n2)=Y/mean(Y);
    end;
end;
clear Y;
P((1:123),101)=M1((15:137),203)/1000;
P((1:7),(1:100))=ones(7,100);
P((117:123),(1:100))=ones(7,100);
for C=1:100
    for fp=8:116
        [H,P(fp,C),ci]=ttest((mean(MM(((fp-7):(fp+7)),C,:),1)-mean(NN(((fp-7):(fp+7)),C,:),1)),0,0.05,1);
    end;
end;
SigChN(1:7)=[0 0 0 0 0 0 0];
SigChN(117:123)=[0 0 0 0 0 0 0];
for Fp=8:116
    SigChN(Fp)=sum(P(Fp,(1:100))<0.05);
end;
PlotP=[[P;V] [SigChN 0 0 0 0]'];
assignin('base','PlotP',PlotP);
[i,j]=find(PlotP((1:123),(1:100))<0.05);
X=[i j];
for k=1:size(X,1)
    if PlotP(125,X(k,2))>0
        plot3(PlotP(126,X(k,2)),PlotP(127,X(k,2)),PlotP(X(k,1),101),'bo'),hold on;
    else
        plot3(PlotP(126,X(k,2)),PlotP(127,X(k,2)),PlotP(X(k,1),101),'b.'),hold on;
    end;
end;
plot3(PlotP(126,find(PlotP(125,(1:100))>0)),PlotP(127,find(PlotP(125,(1:100))>0)),ones(nnz(PlotP(125,(1:100))>0)),'ko'),hold on;
plot3(PlotP(126,find(PlotP(125,(1:100))==0)),PlotP(127,find(PlotP(125,(1:100))==0)),ones(nnz(PlotP(125,(1:100))==0)),'k.'),grid,axis([-60 60 -70 70 1 10]),hold on;          
end
